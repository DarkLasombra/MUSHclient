-- Define the steps for the grind path
steps = {
    {"n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "nw", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "w", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "w", "s", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"search shelves", "get gloves", "keep gloves", "n", "n", "w", "w", "w", "s", "get key", "keep key", "drink pool 9", "n", "e", "e", "e", "s", "s", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "s", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "unlock door", "open door", "w", "get key", "keep key", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "n", "n", "n", "n", "e", "e", "e", "e", "s", "s", "s", "s", "w", "w", "w", "s", "w", "w", "w", "n", "n", "w", "w", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "unlock door", "open door", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "sw", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "w", "w", "nw", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "nw", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "nw", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "sw", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "se", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "w", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "s", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "e", "e", "n", "ne", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "e", "kill golem"},
    {"kill golem"},
    {"get all", "put all in bag", "n", "kill kill zelligar"}
}


-- Global variables
currentStepIndex = 0
zellGrindActive = false
pauseGrind = false

-- Function to process the next step
function processNextStep()
    if not zellGrindActive then
        ColourNote("red", "black", "Grind stopped.")
        return
    end

    -- Check if all steps are completed
    if currentStepIndex >= #steps then
        ColourNote("green", "black", "Zelligar grind path completed!")
        zellGrindActive = false
        return
    end

    -- Move to the next step
    currentStepIndex = currentStepIndex + 1
    local commands = steps[currentStepIndex]

    -- Send all commands for this step
    for _, command in ipairs(commands) do
        Send(command)
    end
end

-- Trigger: Recovery Finished (advances to next step)
function onRecovery(name, line, wildcards)
    if zellGrindActive and not pauseGrind then
        processNextStep()
    end
end

-- Function to start the grind
function startGrind()
    if zellGrindActive then
        ColourNote("yellow", "black", "Grind already in progress!")
        return
    end

    zellGrindActive = true
    currentStepIndex = 0
    ColourNote("cyan", "black", "Starting Zelligar grind...")
    processNextStep()
end

-- Function to stop the grind
function stopGrind()
    zellGrindActive = false
    ColourNote("red", "black", "Zelligar grind stopped.")
end

-- Function to pause the grind
function pauseGrindFunction()
    pauseGrind = true
    ColourNote("yellow", "black", "Grind paused.")
end

-- Function to resume the grind
function resumeGrindFunction()
    if zellGrindActive and pauseGrind then
        pauseGrind = false
        ColourNote("cyan", "black", "Resuming grind...")
        processNextStep()
    end
end