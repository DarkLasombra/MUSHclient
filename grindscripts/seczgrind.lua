-- Define the steps for the grind path
steps = {
    -- Level 0
    {"kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 1
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "sw", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 3
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 6
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "sw", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 5
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "ne", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 7
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 11
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 9
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 6
    {"n", "n", "sw", "w", "s", "d", "kill balangool"},
    -- Level 12
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "nw", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 13
    {"kill balangool"},
    {"get all", "sw", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 16
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 18
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 17
    {"kill balangool"},
    {"get all", "sw", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 19
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "proceed", "kill balangool"},
    -- Level 20
    {"kill balangool"},
    {"get all", "sw", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 21
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 24
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "nw", "kill balangool"},
    {"kill balangool"},
    {"get all", "nw", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 25
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 28
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 29
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 20
    {"sw", "s", "d", "kill balangool"},
    -- Level 21
    {"n", "e", "se", "n", "n", "d", "kill balangool"},
    -- Level 30
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 31
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 32
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 33
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "nw", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 34
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 20
    {"sw", "s", "u", "kill balangool"},
    -- Level 22
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 35
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "ne", "kill balangool"},
    {"kill balangool"},
    {"get all", "nw", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 37
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 38
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "ne", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 39
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "proceed", "kill balangool"},
    -- Level 40
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 41
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "ne", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 44
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 45
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    -- Tough boss
    {"dog heel", "get all", "e", "kill balangool"},
    {"dog heel", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 46
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 50
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "sw", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 47
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "enter portal", "kill balangool"},
    -- Level 49
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "nw", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 41
    {"s", "se", "ne", "n", "d", "kill balangool"},
    -- Level 43
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 51
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 52
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 53
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "u", "kill balangool"},
    -- Level 54
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "enter portal", "kill balangool"},
    -- Level 56
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 57
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 58
    {"kill balangool"},
    {"get all", "s", "kill balangool"},
    {"kill balangool"},
    {"get all", "w", "kill balangool"},
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "d", "kill balangool"},
    -- Level 59
    {"kill balangool"},
    {"get all", "n", "kill balangool"},
    {"kill balangool"},
    {"get all", "ne", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "se", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "e", "kill balangool"},
    {"kill balangool"},
    {"get all", "ne", "kill balangool"},
    {"kill balangool"},
    -- Tough boss
    {"get all", "e", "kill balangool"},
    {"get figurine", "get barrier", "d"},
    {"door", "exit", "me"}
}


-- Global variables
currentStepIndex = 0
seczGrindActive = false
pauseGrind = false

-- Function to process the next step
function processNextStep()
    if not seczGrindActive then
        ColourNote("red", "black", "Grind stopped.")
        return
    end

    -- Check if all steps are completed
    if currentStepIndex >= #steps then
        ColourNote("green", "black", "Section Z grind path completed!")
        seczGrindActive = false
        return
    end

    -- Move to the next step
    currentStepIndex = currentStepIndex + 1
    local commands = steps[currentStepIndex]

    -- Send all commands for this step
    for _, command in ipairs(commands) do
        Send(command)
    end
end

-- Trigger: Recovery Finished (advances to next step)
function onRecovery(name, line, wildcards)
    if seczGrindActive and not pauseGrind then
        processNextStep()
    end
end

-- Function to start the grind
function startGrind()
    if seczGrindActive then
        ColourNote("yellow", "black", "Grind already in progress!")
        return
    end

    seczGrindActive = true
    currentStepIndex = 0
    ColourNote("cyan", "black", "Starting Section Z grind...")
    processNextStep()
end

-- Function to stop the grind
function stopGrind()
    seczGrindActive = false
    ColourNote("red", "black", "Section Z grind stopped.")
end

-- Function to pause the grind
function pauseGrindFunction()
    pauseGrind = true
    ColourNote("yellow", "black", "Grind paused.")
end

-- Function to resume the grind
function resumeGrindFunction()
    if seczGrindActive and pauseGrind then
        pauseGrind = false
        ColourNote("cyan", "black", "Resuming grind...")
        processNextStep()
    end
end